<!DOCTYPE html>
<html lang="da">
<head><meta name="generator" content="Hexo 3.8.0">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

	<meta name="author" content="Brian Emilius">
	<meta name="description" content="I recently decided to dig down into the whole thing about blockchains, because I thought it sounded really interesting. I never actually bothered with trying to understand more than the very basic concept of BitCoin, but until now I also never understood what it actually is.
The core concept behind any crypto currency is something called a block chain.">
	<!-- The Open Graph protocol -->
	<meta property="og:url" content="https://brianemilius.com/2017/12/31/So-WhatS-a-Block-Chain/">
	<meta property="og:type" content="blog">
	<meta property="og:title" content="So, What&#39;s A Block Chain?">
	<meta property="og:description" content="I recently decided to dig down into the whole thing about blockchains, because I thought it sounded really interesting. I never actually bothered with trying to understand more than the very basic concept of BitCoin, but until now I also never understood what it actually is.
The core concept behind any crypto currency is something called a block chain.">
	<meta property="og:image" content="/images/icons/icon-152x152.png">
	<meta property="og:article:tag" content="JavaScript"> <meta property="og:article:tag" content="nodejs"> <meta property="og:article:tag" content="crypto currency"> <meta property="og:article:tag" content="block chain"> 
	
	
	<meta property="article:published_time" content="Sun Dec 31 2017 23:28:32 GMT+0100">
	<meta property="article:modified_time" content="Mon May 21 2018 18:07:10 GMT+0200">
	
		
	<!-- The Twitter Card protocol -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:site" content="@KodeBlokDK">
	<meta name="twitter:creator" content="@brianemilius">

	
	<title>So, What&#39;s A Block Chain? - brian emilius . com</title>

	<link rel="manifest" href="/manifest.json">

	<link rel="icon" href="/images/icons/icon-152x152.png">
	<meta name="theme-color" content="#262626">

	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="default">
	<meta name="apple-mobile-web-app-title" content="Alex Jover Blog">
	<link rel="apple-touch-icon" href="/images/icons/icon-152x152.png">

	<meta name="msapplication-TileImage" content="/images/icons/icon-152x152.png">
	<meta name="msapplication-TileColor" content="#000000">
	<!--<link rel="stylesheet" href="/stylesheets/critical.css?__inline=true">-->
</head>
 
<body>
  <div class="siteWrapper">
		<div class="overlay" hidden></div>
<div class="gdpr" hidden>
	<h1>Kære besøgende</h1>
	<p><strong>Ja, dette er endnu en GDPR oplysning.</strong></p>
	<p>Her på kodeblok.dk samler vi absolut ingen data om dig. Men vi gør brug af et kommentar-modul, som bliver leveret af <a href="https://help.disqus.com/terms-and-policies/disqus-privacy-policy" target="_blank">Disqus</a>.</p>
	<p>Disqus sporer og gemmer data om dig. Derfor vil vi på kodeblok.dk give dig muligheden for at vælge, om du vil tillade dette. Dit valg bliver gemt i din egen browser og du kan altid lave dit valg om ved at åbne vores <a href="/Privatliv">privatlivspolitik</a>.</p>
	<input type="checkbox" name="disqus" value="yes" id="input_disqus">
	<label for="input_disqus">Ja tak! Jeg tillader at Disqus sporer og gemmer data om mig via kodeblok.dk</label>
	<button id="gdpr_save">Gem</button>
</div>

  	<header class="siteHeader">
	<a href="/">brian emilius . com</a>
	<span></span>
</header>

    <nav class="primaryNavigation">
	<ul>
		
		<li><a href="/">Hjem</a></li>
		
		<li><a href="/Missionen">Missionen</a></li>
		
		<li><a href="/arkiver">Arkiver</a></li>
		
	</ul>
</nav>

  	<main>
	  	<section>
	<article class="articleFull">
	<header class="articleHeader">
		<!-- Title -->
		<h1>So, What's A Block Chain?</h1>
		
		<!-- Date and Author -->
		<p>31. December 2017</p>
		<p> af Brian Emilius</p>
		
	</header>
	<div class="content">
		<!-- Content -->
		<p>I recently decided to dig down into the whole thing about blockchains, because I thought it sounded really interesting. I never actually bothered with trying to understand more than the very basic concept of BitCoin, but until now I also never understood what it actually is.</p>
<p>The core concept behind any crypto currency is something called a <em>block chain</em>.</p>
<a id="more"></a>
<p>A <em>block</em> is basically a chunk of information - say, a transaction of BitCoin between two parties. Nothing really special about that, you might think. Well, no. There’s nothing special about it. What makes the block chain so special and secure, is that <em>each block also contains the hash of the previous block</em>. This is where the chain concept comes in. Having each previous block verify the validity of the next block means that in order for anyone to manipulate any one block in a chain, they must manipulate every single previous block - and replace them in the block chain datastream.</p>
<p>In a block chain such as BitCoin, which currently has close to 550,000 blocks of information, this would mean a massive amount of time to recalculate all the hashes - somewhere around 10.5 years. Since the avarage calculation time of a block hash is roughly 10 minutes, the original block chain would have moved well past the altered branch of a chain.</p>
<h2 id="So-What’s-In-The-Chain"><a href="#So-What’s-In-The-Chain" class="headerlink" title="So What’s In The Chain?"></a>So What’s In The Chain?</h2><p>As I mentioned above, the block is basically a chunk of information + the hash value of the previous block. This could be expressed as such:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"hash"</span>: <span class="string">"a18408bb1ec7072ff8f19b9e99c1036a1e98d78fd7bb955495eeed90574dae3c"</span>,</span><br><span class="line">    <span class="attr">"id"</span>: <span class="string">"0"</span>,</span><br><span class="line">    <span class="attr">"timestamp"</span>: <span class="number">1514736606835</span>,</span><br><span class="line">    <span class="attr">"data"</span>: &#123;</span><br><span class="line">        <span class="attr">"message"</span>: <span class="string">"Hello, Block Chain! I am the genesis block of this chain."</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In order to create a chain we would first need something called a <em>genesis block</em>. Let us just use the one above.</p>
<p>We also need something called <em>difficulty</em> and <em>nonce</em> to calculate the hash.</p>
<p>And of course functions to generate the hash and the block.</p>
<p>We also need a set of rules that determine whether or not the calculated hash meets our requirements. This is called the <em>difficulty</em>.</p>
<p>What we do is, we generate a hash, then we compare it to the difficulty. If the difficulty is not met, then we add a number to the block, generate a new hash, and try again. This number is called the <em>nonce</em>. We simply start with a nonce of 0, and then add 1 with every attempt.</p>
<p>Let’s say that we want the hash hexidecimal number to be less than or equal to a constant decimal. Now we can determine if a hash is valid or not:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> validHash = <span class="function"><span class="params">hash</span> =&gt;</span> <span class="built_in">parseInt</span>(hash, <span class="number">16</span>) &lt;= <span class="number">1.6532065611505255e+71</span>;</span><br></pre></td></tr></table></figure>
<p>This is not exactly how it’s done with BitCoin, but for the sake of this demonstration it will do just fine.</p>
<p>We will also need to create the <em>genesis block</em> including it’s hash. To generate the hash I will use node.js’ crypto library and the hashing algorithm <em>sha256</em>.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> chain = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initiateChain = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> timestamp = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="keyword">const</span> data = &#123; <span class="string">'message'</span>: <span class="string">'Hello, Block Chain! I am the genesis block if this chain.'</span> &#125;;</span><br><span class="line">    generateBlock(&#123;&#125;, index, timestamp, data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generateBlock = <span class="function">(<span class="params">previousBlock, index, timestamp, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> hash = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">let</span> nonce = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ( !validHash(hash) ) &#123;</span><br><span class="line">        nonce += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">let</span> input = <span class="string">`<span class="subst">$&#123;previousBlock&#125;</span><span class="subst">$&#123;index&#125;</span><span class="subst">$&#123;timestamp&#125;</span><span class="subst">$&#123;data&#125;</span><span class="subst">$&#123;nonce&#125;</span>`</span>;</span><br><span class="line">        hash = crypto.createHash(<span class="string">'sha256'</span>).update(input).digest(<span class="string">'hex'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    chain.push(&#123;</span><br><span class="line">        hash,</span><br><span class="line">        index,</span><br><span class="line">        timestamp,</span><br><span class="line">        data,</span><br><span class="line">        nonce</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Finally, in order to add a new block to the chain, we need to be able to get the last block of the chain and make a function which adds the new block to the chain.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> getLastBlock = <span class="function"><span class="params">chain</span> =&gt;</span> chain.slice(<span class="number">-1</span>)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addNewBlock = <span class="function"><span class="params">data</span> =&gt;</span> generateBlock(getLastBlock(chain), chain.length, <span class="built_in">Date</span>.now(), data);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getChain = <span class="function"><span class="params">()</span> =&gt;</span> chain;</span><br></pre></td></tr></table></figure>
<p>Let’s wrap it all up nicely in a module and expose only the functions needed.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">'crypto'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> chain = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> initiateChain = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">const</span> timestamp = <span class="built_in">Date</span>.now();</span><br><span class="line">        <span class="keyword">const</span> data = &#123; <span class="string">'message'</span>: <span class="string">'Hello, Block Chain! I am the genesis block if this chain.'</span> &#125;;</span><br><span class="line">        generateBlock(&#123;&#125;, index, timestamp, data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> generateBlock = <span class="function">(<span class="params">previousBlock, index, timestamp, data</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> hash = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">let</span> nonce = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> ( !validHash(hash) ) &#123;</span><br><span class="line">            nonce += <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">let</span> input = <span class="string">`<span class="subst">$&#123;previousBlock&#125;</span><span class="subst">$&#123;index&#125;</span><span class="subst">$&#123;timestamp&#125;</span><span class="subst">$&#123;data&#125;</span><span class="subst">$&#123;nonce&#125;</span>`</span>;</span><br><span class="line">            hash = crypto.createHash(<span class="string">'sha256'</span>).update(input).digest(<span class="string">'hex'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        chain.push(&#123;</span><br><span class="line">            hash,</span><br><span class="line">            index,</span><br><span class="line">            timestamp,</span><br><span class="line">            data,</span><br><span class="line">            nonce</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> getLastBlock = <span class="function"><span class="params">chain</span> =&gt;</span> chain.slice(<span class="number">-1</span>)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> validHash = <span class="function"><span class="params">hash</span> =&gt;</span> <span class="built_in">parseInt</span>(hash, <span class="number">16</span>) &lt;= <span class="number">1.6532065611505255e+71</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> addNewBlock = <span class="function"><span class="params">data</span> =&gt;</span> generateBlock(getLastBlock(chain), chain.length, <span class="built_in">Date</span>.now(), data);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> getChain = <span class="function"><span class="params">()</span> =&gt;</span> chain;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        initiateChain,</span><br><span class="line">        addNewBlock,</span><br><span class="line">        getChain</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>And, of course, test it out:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> chain = <span class="built_in">require</span>(<span class="string">'./chain'</span>);</span><br><span class="line"></span><br><span class="line">chain.initiateChain();</span><br><span class="line"></span><br><span class="line">chain.addNewBlock(&#123; <span class="string">'title'</span>: <span class="string">'Alice In Wonderland'</span> &#125;);</span><br><span class="line">chain.addNewBlock(&#123; <span class="string">'quote'</span>: <span class="string">'“But I don’t want to go among mad people," Alice remarked.\n"Oh, you can’t help that," said the Cat: "we’re all mad here. I’m mad. You’re mad."\n"How do you know I’m mad?" said Alice.\n"You must be," said the Cat, "or you wouldn’t have come here.”'</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(chain.getChain());</span><br></pre></td></tr></table></figure>
<p>That should output something along the lines of this:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">[ &#123; <span class="attr">hash</span>: <span class="string">'00000959b93d4093ce9275fb4f2388a7aaf247e86b6a5179569e33a3970b4254'</span>,</span><br><span class="line">    index: <span class="number">0</span>,</span><br><span class="line">    timestamp: <span class="number">1514758633771</span>,</span><br><span class="line">    data:</span><br><span class="line">     &#123; <span class="attr">message</span>: <span class="string">'Hello, Block Chain! I am the genesis block if this chain.'</span> &#125;,</span><br><span class="line">    nonce: <span class="number">91248</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">hash</span>: <span class="string">'00000a3ab5bc9556d9650b0dd8d7e170ddc70dcf669d2847e5b1f12eb64abc71'</span>,</span><br><span class="line">    index: <span class="number">1</span>,</span><br><span class="line">    timestamp: <span class="number">1514758637657</span>,</span><br><span class="line">    data: &#123; <span class="attr">title</span>: <span class="string">'Alice In Wonderland'</span> &#125;,</span><br><span class="line">    nonce: <span class="number">738722</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">hash</span>: <span class="string">'0000069125ef74d3e3f358b2228afa70907c96b9a2a9944e3b8d9cf825b1054c'</span>,</span><br><span class="line">    index: <span class="number">2</span>,</span><br><span class="line">    timestamp: <span class="number">1514758668904</span>,</span><br><span class="line">    data:</span><br><span class="line">     &#123; <span class="attr">quote</span>: <span class="string">'“But I don’t want to go among mad people," Alice remarked.\n"Oh, you can’t help that," said the Cat: "we’re all mad here. I’m mad. You’re mad."\n"How do you know I’m mad?" said Alice.\n"You must be," said the Cat, "or you wouldn’t have come here.”'</span> &#125;,</span><br><span class="line">    nonce: <span class="number">137742</span> &#125; ]</span><br></pre></td></tr></table></figure>
<p>3 blocks, each hashed and verified by the previous block in the chain.</p>
<p>If you take a look at the <code>nonce</code> value in eacvh block, you can see how many guesses were needed until an appropriate hash could be generated. Remember that really large exponent decimal in the <code>validHash</code>-function? The lower that decimal is, the more difficult it is to generate a hash.</p>
<p>I have certainly learned a lot about block chain theory writing this post up. I hope you enjoyed reading it. If you did, or if you found an error or a typo somewhere, please leave a comment and a share below.</p>
<p>I wish you a very happy New Year!</p>

	</div>
	
	<footer>
		<!-- Tags and Categories links -->
		
	
	<div class="blog-tags-container">
			<span class="glyphicon glyphicon-tags"></span>
			<a href="/tags/JavaScript/">#JavaScript</a> <a href="/tags/nodejs/">#nodejs</a> <a href="/tags/crypto-currency/">#crypto currency</a> <a href="/tags/block-chain/">#block chain</a>
	</div>
	
		Dette indlæg er offentliggjort i 
	
	<a href="/kategorier/Kryptografi/">Kryptografi</a> / <a href="/kategorier/Kryptografi/Block-Chain/">Block Chain</a>

	</footer>
	
</article>

<aside>
	<div id="disqus_thread"></div>
</aside>

<script>

	/**
	*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
	*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
	/*
	var disqus_config = function () {
	this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
	this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
	};
	*/
	const disqusOptIn = localStorage.getItem('disqusOptIn');
	console.log(disqusOptIn);
	if (disqusOptIn) {
		(function() { // DON'T EDIT BELOW THIS LINE
		var d = document, s = d.createElement('script');
		s.src = 'https://brianeemilius.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
		})();
	}
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	
</section>
	  </main>

	  <div class="widgets">
	<div class="searchForm">
		<form>
			<h4><label for="search">Søg</label></h4>
			<input type="search" id="search" name="search" placeholder="skriv din søgetekst her...">
			<div class="ajaxSearchResults"></div>
		</form>
	</div>

	<div class="contribute">
		<h4>Bliv en del af kodeblok.dk</h4>
		<div>
			<p>Kunne du tænke dig at skrive for kodeblok.dk?</p>
			<p>Vi har brug for udviklere, der gerne vil bidrage.</p>
			<p><a href="">Læs mere</a></p>
		</div>
	</div>
			

	<div class="categories">
		<h4>Kategorier</h4>
		<div>
			<ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/kategorier/Accessability/">Accessability</a></li><li class="category-list-item"><a class="category-list-link" href="/kategorier/Design/">Design</a></li><li class="category-list-item"><a class="category-list-link" href="/kategorier/Guides/">Guides</a></li><li class="category-list-item"><a class="category-list-link" href="/kategorier/Kryptografi/">Kryptografi</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/kategorier/Kryptografi/Block-Chain/">Block Chain</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/kategorier/Renere-kode/">Renere kode</a></li></ul>
		</div>
	</div>



	<div class="tags">
		<h4>Tags</h4>
		<div>
			<a href="/tags/CSS/" style="font-size: 16.67px;">CSS</a> <a href="/tags/JSON/" style="font-size: 10px;">JSON</a> <a href="/tags/JavaScript/" style="font-size: 20px;">JavaScript</a> <a href="/tags/Photoshop/" style="font-size: 10px;">Photoshop</a> <a href="/tags/SPA/" style="font-size: 10px;">SPA</a> <a href="/tags/Typografi/" style="font-size: 10px;">Typografi</a> <a href="/tags/UX/" style="font-size: 10px;">UX</a> <a href="/tags/a11y/" style="font-size: 10px;">a11y</a> <a href="/tags/babel-js/" style="font-size: 10px;">babel.js</a> <a href="/tags/best-practice/" style="font-size: 13.33px;">best-practice</a> <a href="/tags/block-chain/" style="font-size: 10px;">block chain</a> <a href="/tags/crypto-currency/" style="font-size: 10px;">crypto currency</a> <a href="/tags/dokumentation/" style="font-size: 10px;">dokumentation</a> <a href="/tags/es6-modules/" style="font-size: 10px;">es6 modules</a> <a href="/tags/gulp/" style="font-size: 10px;">gulp</a> <a href="/tags/hash/" style="font-size: 10px;">hash</a> <a href="/tags/hmac/" style="font-size: 10px;">hmac</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/matematik/" style="font-size: 10px;">matematik</a> <a href="/tags/node-js/" style="font-size: 10px;">node.js</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/optimering/" style="font-size: 10px;">optimering</a> <a href="/tags/router/" style="font-size: 10px;">router</a> <a href="/tags/sha/" style="font-size: 10px;">sha</a> <a href="/tags/templates/" style="font-size: 10px;">templates</a>
		</div>
	</div>


</div>

	
		<footer class="siteFooter">
	<p>Ophavsret &copy; 2015-2019 brianemilius.com. Alle rettigheder forbeholdes. <a href="/Privatliv">Privatliv</a></p>
</footer>
  </div>
	<script src="/javascripts/main.js"></script>
<script src="/javascripts/register-sw.js"></script>
<script>
	const cssLoader = function (src) {
		const stylesheet = document.createElement('link');
		stylesheet.href = src;
		stylesheet.rel = 'stylesheet';
		stylesheet.type = 'text/css';
		document.getElementsByTagName('head')[0].appendChild(stylesheet);
	};
	document.addEventListener('DOMContentLoaded', () => {
		cssLoader('/stylesheets/style.css');
	});
</script>
</body>
</html>
